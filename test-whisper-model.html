<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Whisper Model Loading</title>
</head>
<body>
    <h1>Testing Whisper Model Loading</h1>
    <div id="status">Initializing...</div>
    <div id="progress"></div>
    <div id="error" style="color: red;"></div>
    
    <script type="module">
        import { pipeline, env } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.2';
        
        // Configure for local models
        env.allowLocalModels = true;
        env.allowRemoteModels = false;
        env.localModelPath = '/models/';
        env.useBrowserCache = false;
        
        const statusDiv = document.getElementById('status');
        const progressDiv = document.getElementById('progress');
        const errorDiv = document.getElementById('error');
        
        async function testModelLoading() {
            try {
                statusDiv.textContent = 'Loading Whisper model...';
                
                const transcriber = await pipeline(
                    'automatic-speech-recognition',
                    '/models/whisper-tiny',
                    {
                        progress_callback: (progress) => {
                            progressDiv.textContent = `Progress: ${JSON.stringify(progress)}`;
                            console.log('Progress:', progress);
                        }
                    }
                );
                
                statusDiv.textContent = 'Model loaded successfully!';
                console.log('Model loaded:', transcriber);
                
            } catch (error) {
                console.error('Error loading model:', error);
                errorDiv.textContent = `Error: ${error.message}`;
                statusDiv.textContent = 'Failed to load model';
            }
        }
        
        // Test model loading
        testModelLoading();
    </script>
</body>
</html>